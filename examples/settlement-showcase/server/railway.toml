# Railway deployment configuration for Settlement Showcase Server
# 
# IMPORTANT: In Railway Dashboard, set "Root Directory" to "/" (project root)
# This allows pnpm to properly resolve workspace dependencies
#
# NOTE: Railway will automatically handle Git submodule cloning during the clone step.
# The git directory is not available inside the Docker container, so git commands
# should not be used in buildCommand.

[build]
builder = "NIXPACKS"
buildCommand = "pnpm install --frozen-lockfile && pnpm --filter=settlement-showcase-server build"
watchPatterns = ["examples/settlement-showcase/server/**", "deps/x402/**"]

[deploy]
startCommand = "node examples/settlement-showcase/server/dist/index.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[env]
NODE_VERSION = "20"
PNPM_VERSION = "10.7.0"

